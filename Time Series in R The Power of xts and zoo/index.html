



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A R documentation website.">
      
      
        <link rel="canonical" href="https://ugoproto.github.io/ugo_r_doc/Time Series in R The Power of xts and zoo/">
      
      
        <meta name="author" content="Ugo Sparks">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.2.0">
    
    
      
        <title>Time Series in R, The Power of xts and zoo - ugo_r_doc</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.572ca0f0.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../assets/javascripts/modernizr.8c900955.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="red">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#introduction-to-extensible-time" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://ugoproto.github.io/ugo_r_doc/" title="ugo_r_doc" class="md-header-nav__button md-logo">
          
            <i class="md-icon">layers</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                ugo_r_doc
              </span>
              <span class="md-header-nav__topic">
                Time Series in R, The Power of xts and zoo
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/ugoproto/ugo_r_doc.git/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      ugo_r_doc
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://ugoproto.github.io/ugo_r_doc/" title="ugo_r_doc" class="md-nav__button md-logo">
      
        <i class="md-icon">layers</i>
      
    </a>
    ugo_r_doc
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/ugoproto/ugo_r_doc.git/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      ugo_r_doc
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Basics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Basics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../R_CS/" title="R Cheat Sheets" class="md-nav__link">
      R Cheat Sheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../An Introduction to R/" title="An Introduction to R" class="md-nav__link">
      An Introduction to R
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Le logiciel R, maitriser le langage, effectuer des analyses (bio)statistiques/" title="Le logiciel R, maitriser le langage, effectuer des analyses (bio)statistiques" class="md-nav__link">
      Le logiciel R, maitriser le langage, effectuer des analyses (bio)statistiques
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Formulas_in_R/" title="Formulas in R" class="md-nav__link">
      Formulas in R
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Improved_codes/" title="Improved Codes" class="md-nav__link">
      Improved Codes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Intermediate_R/" title="Intermediate R" class="md-nav__link">
      Intermediate R
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Intermediate_R_-_The_apply_Family/" title="Intermediate R - The apply Family" class="md-nav__link">
      Intermediate R - The apply Family
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      RStudio
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        RStudio
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Code___Plot_Chunk_Options/" title="Code & Plot Chunk Options" class="md-nav__link">
      Code & Plot Chunk Options
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Working_with_RStudio_IDE/" title="Working with the RStudio IDE" class="md-nav__link">
      Working with the RStudio IDE
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Data Wrangling Snippets
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Data Wrangling Snippets
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../IO_snippets___Cleaning/" title="I/O Snippets & Cleaning" class="md-nav__link">
      I/O Snippets & Cleaning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Reading_Data_into_R_with_readr/" title="Reading Data into R with readr" class="md-nav__link">
      Reading Data into R with readr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Data_Analysis_in_R,_the_data.table_Way/" title="Data Analysis in R, the data.table Way" class="md-nav__link">
      Data Analysis in R, the data.table Way
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Data_Manipulation_in_R_with_dplyr/" title="Data Manipulation in R with dplyr" class="md-nav__link">
      Data Manipulation in R with dplyr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Data_Wrangling/" title="Data Wrangling" class="md-nav__link">
      Data Wrangling
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Plot Snippets
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Plot Snippets
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Plot_snippets_-_Basics/" title="Plot Snippets for Exploratory (and some Explanatory) Analyses" class="md-nav__link">
      Plot Snippets for Exploratory (and some Explanatory) Analyses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Plot_snippets_-_ggplot2/" title="Plot Snippets - ggplot2" class="md-nav__link">
      Plot Snippets - ggplot2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Plot_snippets_-_ggvis/" title="Plot Snippets - ggvis" class="md-nav__link">
      Plot Snippets - ggvis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Plot_snippets_-_Colours/" title="Plot Snippets - Colours" class="md-nav__link">
      Plot Snippets - Colours
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Packages
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Packages
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../googleVis/" title="googleVis (embed HTML plots)" class="md-nav__link">
      googleVis (embed HTML plots)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gganimate/" title="gganimate" class="md-nav__link">
      gganimate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Fast-and-Frugal_Decision_Trees_in_R_with_FFTrees/" title="Fast-and-Frugal Decision Trees" class="md-nav__link">
      Fast-and-Frugal Decision Trees
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Big_Data_Analysis_with_Revolution_R_Enterprise/" title="Big Data Analysis with Revolution R Enterprise" class="md-nav__link">
      Big Data Analysis with Revolution R Enterprise
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Time Series in R, The Power of xts and zoo
      </label>
    
    <a href="./" title="Time Series in R, The Power of xts and zoo" class="md-nav__link md-nav__link--active">
      Time Series in R, The Power of xts and zoo
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-extensible-time" title="Introduction to eXtensible Time" class="md-nav__link">
    Introduction to eXtensible Time
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#first-order-of-business-basic-manipulations" title="First Order of Business -- Basic Manipulations" class="md-nav__link">
    First Order of Business -- Basic Manipulations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#merging-and-modifying-time-series" title="Merging and modifying time series" class="md-nav__link">
    Merging and modifying time series
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apply-and-aggregate-by-time" title="Apply and aggregate by time" class="md-nav__link">
    Apply and aggregate by time
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extra-features-of-xts" title="Extra features of xts" class="md-nav__link">
    Extra features of xts
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Parallel computing in R/" title="Parallel computing in R" class="md-nav__link">
      Parallel computing in R
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Other Snippets
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Other Snippets
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Tables/" title="Tables" class="md-nav__link">
      Tables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../embedding/" title="Embedding HTML into HTML" class="md-nav__link">
      Embedding HTML into HTML
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../embedding2/" title="Embedding Rmd into Rmd" class="md-nav__link">
      Embedding Rmd into Rmd
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Frequentist_Bayesian/" title="Frequentist vs. Bayesian" class="md-nav__link">
      Frequentist vs. Bayesian
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      A Hands-on Introduction to Statistics with R
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        A Hands-on Introduction to Statistics with R
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_One,_Introduction/" title="Statistics with R, Course One, Introduction" class="md-nav__link">
      Statistics with R, Course One, Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Two,_Student_s_T-test/" title="Statistics with R, Course Two, Student's t-test" class="md-nav__link">
      Statistics with R, Course Two, Student's t-test
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Three,_Analysis_of_Variance/" title="Statistics with R, Course Three, Analysis of Variance" class="md-nav__link">
      Statistics with R, Course Three, Analysis of Variance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Four,_Repeated_Measures_Anova/" title="Statistics with R, Course Four, Repeated Measures ANOVA" class="md-nav__link">
      Statistics with R, Course Four, Repeated Measures ANOVA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Five,_Correlation_and_Regression/" title="Statistics with R, Course Five, Correlation and Regression" class="md-nav__link">
      Statistics with R, Course Five, Correlation and Regression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Six,_Multiple_Regression/" title="Statistics with R, Course Six, Multiple Regression" class="md-nav__link">
      Statistics with R, Course Six, Multiple Regression
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../A_Hands-on_Introduction_to_Statistics_with_R,_Course_Seven,_Moderation_and_Mediation/" title="Statistics with R, Course Seven, Moderation and Mediation" class="md-nav__link">
      Statistics with R, Course Seven, Moderation and Mediation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../A_Hands-on_Introduction_to_Statistics_with_R,_Notes/" title="Statistics with R, Notes" class="md-nav__link">
      Statistics with R, Notes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-to-extensible-time" title="Introduction to eXtensible Time" class="md-nav__link">
    Introduction to eXtensible Time
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#first-order-of-business-basic-manipulations" title="First Order of Business -- Basic Manipulations" class="md-nav__link">
    First Order of Business -- Basic Manipulations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#merging-and-modifying-time-series" title="Merging and modifying time series" class="md-nav__link">
    Merging and modifying time series
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apply-and-aggregate-by-time" title="Apply and aggregate by time" class="md-nav__link">
    Apply and aggregate by time
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extra-features-of-xts" title="Extra features of xts" class="md-nav__link">
    Extra features of xts
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ugoproto/ugo_r_doc.git/edit/master/docs/Time Series in R The Power of xts and zoo.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Time Series in R, The Power of xts and zoo</h1>
                
                <!--

-->

<hr />
<p><strong>Foreword</strong></p>
<ul>
<li>Snippets and results.</li>
<li>Source: &lsquo;Time Series in R, The Power of <code class="codehilite">xts</code> and <code class="codehilite">zoo</code>&lsquo; from DataCamp fitted into Jupyter/IPython using the IRkernel.</li>
</ul>
<hr />
<h3 id="introduction-to-extensible-time">Introduction to eXtensible Time<a class="headerlink" href="#introduction-to-extensible-time" title="Permanent link">&para;</a></h3>
<p><strong>What is an <code class="codehilite">xts</code> object</strong></p>
<p><code class="codehilite">xts</code>, a constructor or a subclass that inherits behavior from parents. <code class="codehilite">xts</code> (as a subclass) extends the popular <code class="codehilite">zoo</code> class (as a parent). Most <code class="codehilite">zoo</code> methods work for <code class="codehilite">xts</code>. </p>
<p><code class="codehilite">xts</code> is a matrix objects; subsets always preserve the matrix form. </p>
<p><code class="codehilite">xts</code> are indexed by a formal time object. You can time-stamp the data.</p>
<p>The main <code class="codehilite">xts</code> constructor two most important arguments are <code class="codehilite">x</code> for the data and <code class="codehilite">order.by</code> for the index. <code class="codehilite">x</code> must be a vector or matrix. <code class="codehilite">order.by</code> is a vector of the same length or number of rows of <code class="codehilite">x</code>; it must be a proper time or date object and it must be in increasing order.</p>
<p><code class="codehilite">xts</code> also allows you to bind arbitrary key-value attributes to your data. This lets you keep metadata about your object inside your object.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># load zoo</span>
<span class="kn">library</span><span class="p">(</span>zoo<span class="p">)</span>
<span class="c1"># Load xts</span>
<span class="kn">library</span><span class="p">(</span>xts<span class="p">)</span> <span class="c1"># could be done alone; it will call zoo</span>
</pre></div>
</td></tr></table>

<p><strong>A first <code class="codehilite">xts</code> object</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>core <span class="o">&lt;-</span> <span class="kt">matrix</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="kp">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">),</span> <span class="kp">rep</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">)),</span> nrow <span class="o">=</span> <span class="m">3</span><span class="p">,</span> ncol <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
core

idx <span class="o">&lt;-</span> <span class="kp">as.Date</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;2016-06-01&quot;</span><span class="p">,</span><span class="s">&quot;2016-06-02&quot;</span><span class="p">,</span> <span class="s">&quot;2016-06-03&quot;</span><span class="p">))</span>
idx

ex_matrix <span class="o">&lt;-</span> xts<span class="p">(</span>core<span class="p">,</span> order.by <span class="o">=</span> idx<span class="p">)</span>
ex_matrix
</pre></div>
</td></tr></table>

<table>
<tbody>
    <tr><td>1</td><td>2</td></tr>
    <tr><td>1</td><td>2</td></tr>
    <tr><td>1</td><td>2</td></tr>
</tbody>
</table>

<ol>
    <li><time datetime="2016-06-01">2016-06-01</time></li>
    <li><time datetime="2016-06-02">2016-06-02</time></li>
    <li><time datetime="2016-06-03">2016-06-03</time></li>
</ol>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>           [,1] [,2]
2016-06-01    1    2
2016-06-02    1    2
2016-06-03    1    2
</pre></div>
</td></tr></table>

<p><strong>More than a matrix</strong></p>
<p><code class="codehilite">xts</code> objects are normal R matrices, but with special powers.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># View the structure of ex_matrix</span>
str<span class="p">(</span>ex_matrix<span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>An ‘xts’ object on 2016-06-01/2016-06-03 containing:
  Data: num [1:3, 1:2] 1 1 1 2 2 2
  Indexed by objects of class: [Date] TZ: UTC
  xts Attributes:  
 NULL
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Extract the 3rd observation of the 2nd column of ex_matrix</span>
ex_matrix<span class="p">[</span><span class="m">3</span><span class="p">,</span> <span class="m">2</span><span class="p">]</span>

<span class="c1"># Extract the 3rd observation of the 2nd column of core </span>
core<span class="p">[</span><span class="m">3</span><span class="p">,</span> <span class="m">2</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>           [,1]
2016-06-03    2
</pre></div>
</td></tr></table>

<p>2</p>
<p><strong>Your first xts object</strong></p>
<p>Vector must be of the same length or number of rows as x and, this is very important: it must be a proper time or date object and it must be in increasing order.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Create the object data using 5 random numbers</span>
data <span class="o">&lt;-</span> rnorm<span class="p">(</span><span class="m">5</span><span class="p">)</span>
data

<span class="c1"># Create dates as a Date class object starting from 2016-01-01</span>
dates <span class="o">&lt;-</span> <span class="kp">seq</span><span class="p">(</span><span class="kp">as.Date</span><span class="p">(</span><span class="s">&quot;2016-01-01&quot;</span><span class="p">),</span> length <span class="o">=</span> <span class="m">5</span><span class="p">,</span> by <span class="o">=</span> <span class="s">&quot;days&quot;</span><span class="p">)</span>
dates

<span class="c1"># Use xts() to create smith</span>
smith <span class="o">&lt;-</span> xts<span class="p">(</span>x <span class="o">=</span> data<span class="p">,</span> order.by <span class="o">=</span> dates<span class="p">)</span>
smith

<span class="c1"># Create bday (1899-05-08) using a POSIXct date class object</span>
bday <span class="o">&lt;-</span> <span class="kp">as.POSIXct</span><span class="p">(</span><span class="s">&quot;1899-05-08&quot;</span><span class="p">)</span>
bday

<span class="c1"># Create hayek and add a new attribute called born</span>
hayek <span class="o">&lt;-</span> xts<span class="p">(</span>x <span class="o">=</span> data<span class="p">,</span> order.by <span class="o">=</span> dates<span class="p">,</span> born <span class="o">=</span> bday<span class="p">)</span>
hayek
</pre></div>
</td></tr></table>

<ol>
    <li>0.226117402549514</li>
    <li>-0.214261010302668</li>
    <li>-0.199347621952038</li>
    <li>0.133952199089896</li>
    <li>0.96057628145059</li>
</ol>

<ol>
    <li><time datetime="2016-01-01">2016-01-01</time></li>
    <li><time datetime="2016-01-02">2016-01-02</time></li>
    <li><time datetime="2016-01-03">2016-01-03</time></li>
    <li><time datetime="2016-01-04">2016-01-04</time></li>
    <li><time datetime="2016-01-05">2016-01-05</time></li>
</ol>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>                 [,1]
2016-01-01  0.2261174
2016-01-02 -0.2142610
2016-01-03 -0.1993476
2016-01-04  0.1339522
2016-01-05  0.9605763



[1] &quot;1899-05-08 EST&quot;



                 [,1]
2016-01-01  0.2261174
2016-01-02 -0.2142610
2016-01-03 -0.1993476
2016-01-04  0.1339522
2016-01-05  0.9605763
</pre></div>
</td></tr></table>

<p><strong>Deconstructing xts</strong></p>
<p>Separate a time series into its core data and index attributes for additional analysis and manipulation.</p>
<p>Functions are methods from the <code class="codehilite">zoo</code> class.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Extract the core data of hayek</span>
hayek_core <span class="o">&lt;-</span> coredata<span class="p">(</span>hayek<span class="p">)</span>

<span class="c1"># View the class of hayek_core</span>
<span class="kp">class</span><span class="p">(</span>hayek_core<span class="p">)</span>

<span class="c1"># Extract the index of hayek</span>
hayek_index <span class="o">&lt;-</span> index<span class="p">(</span>hayek<span class="p">)</span>

<span class="c1"># View the class of hayek_index</span>
<span class="kp">class</span><span class="p">(</span>hayek_index<span class="p">)</span>
</pre></div>
</td></tr></table>

<p>&lsquo;matrix&rsquo;</p>
<p>&lsquo;Date&rsquo;</p>
<p><strong>Time-based indices</strong></p>
<p><code class="codehilite">xts</code> objects get their power from the index attribute that holds the time dimension. One major difference between <code class="codehilite">xts</code> and most other time series objects in R is the ability to use any one of various classes that are used to represent time. Whether <code class="codehilite">POSIXct</code>, <code class="codehilite">Date</code>, or some other class, xts will convert this into an internal form to make subsetting as natural to the user as possible.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Create dates</span>
dates <span class="o">&lt;-</span> <span class="kp">as.Date</span><span class="p">(</span><span class="s">&quot;2016-01-01&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="m">0</span><span class="o">:</span><span class="m">4</span>

<span class="c1"># Create ts_a</span>
ts_a <span class="o">&lt;-</span> xts<span class="p">(</span>x <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">,</span> order.by <span class="o">=</span> dates<span class="p">)</span>

<span class="c1"># Create ts_b</span>
ts_b <span class="o">&lt;-</span> xts<span class="p">(</span>x <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">,</span> order.by <span class="o">=</span> <span class="kp">as.POSIXct</span><span class="p">(</span>dates<span class="p">))</span>

<span class="c1"># Extract the rows of ts_a using the index of ts_b</span>
ts_a<span class="p">[</span>index<span class="p">(</span>ts_a<span class="p">)]</span>

<span class="c1"># Extract the rows of ts_b using the index of ts_a</span>
ts_b<span class="p">[</span>index<span class="p">(</span>ts_a<span class="p">)]</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>           [,1]
2016-01-01    1
2016-01-02    2
2016-01-03    3
2016-01-04    4
2016-01-05    5



     [,1]
</pre></div>
</td></tr></table>

<h3 id="first-order-of-business-basic-manipulations">First Order of Business &ndash; Basic Manipulations<a class="headerlink" href="#first-order-of-business-basic-manipulations" title="Permanent link">&para;</a></h3>
<p><strong>Converting xts objects</strong></p>
<p><code class="codehilite">xts</code> provides methods to convert all of the major objects you are likely to come across - suitable native R types like matrix, data.frame, and ts are supported, as well as contributed ones such as <code class="codehilite">timeSeries</code>, <code class="codehilite">fts</code> and of course <code class="codehilite">zoo</code>. <code class="codehilite">as.xts</code> is the workhorse function to do the conversions to <code class="codehilite">xts</code>, and similar functions will provide the reverse behavior.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># using a R dataset</span>
<span class="kp">head</span><span class="p">(</span>austres<span class="p">)</span>
</pre></div>
</td></tr></table>

<ol>
    <li>13067.3</li>
    <li>13130.5</li>
    <li>13198.4</li>
    <li>13254.2</li>
    <li>13303.7</li>
    <li>13353.9</li>
</ol>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Convert austres to an xts object called au</span>
au <span class="o">&lt;-</span> as.xts<span class="p">(</span>austres<span class="p">)</span>
<span class="kp">head</span><span class="p">(</span>au<span class="p">,</span> <span class="m">5</span><span class="p">)</span>

<span class="c1"># Convert your xts object (au) into a matrix am</span>
am <span class="o">&lt;-</span> <span class="kp">as.matrix</span><span class="p">(</span>au<span class="p">)</span>
<span class="kp">head</span><span class="p">(</span>am<span class="p">,</span> <span class="m">5</span><span class="p">)</span>

<span class="c1"># Convert the original austres into a matrix am2</span>
am2 <span class="o">&lt;-</span> <span class="kp">as.matrix</span><span class="p">(</span>austres<span class="p">)</span>
<span class="kp">head</span><span class="p">(</span>am2<span class="p">,</span> <span class="m">5</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>           [,1]
1971 Q2 13067.3
1971 Q3 13130.5
1971 Q4 13198.4
1972 Q1 13254.2
1972 Q2 13303.7
</pre></div>
</td></tr></table>

<table>
<tbody>
    <tr><th scope=row>1971 Q2</th><td>13067.3</td></tr>
    <tr><th scope=row>1971 Q3</th><td>13130.5</td></tr>
    <tr><th scope=row>1971 Q4</th><td>13198.4</td></tr>
    <tr><th scope=row>1972 Q1</th><td>13254.2</td></tr>
    <tr><th scope=row>1972 Q2</th><td>13303.7</td></tr>
</tbody>
</table>

<table>
<tbody>
    <tr><td>13067.3</td></tr>
    <tr><td>13130.5</td></tr>
    <tr><td>13198.4</td></tr>
    <tr><td>13254.2</td></tr>
    <tr><td>13303.7</td></tr>
</tbody>
</table>

<p><strong>Importing data</strong></p>
<p>Read raw data from files on disk or the web and convert data to <code class="codehilite">xts</code>.</p>
<p>Read the same data into a <code class="codehilite">zoo</code> object using read.zoo and convert the <code class="codehilite">zoo</code> into an <code class="codehilite">xts</code> object.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Create dat by reading tmp_file</span>
dat <span class="o">&lt;-</span> <span class="kp">as.matrix</span><span class="p">(</span>read.csv<span class="p">(</span><span class="s">&#39;tmp_file.csv&#39;</span><span class="p">,</span> sep <span class="o">=</span> <span class="s">&#39;,&#39;</span><span class="p">,</span> header <span class="o">=</span> <span class="kc">TRUE</span><span class="p">))</span>
dat
</pre></div>
</td></tr></table>

<table>
<thead><tr><th></th><th scope=col>a</th><th scope=col>b</th></tr></thead>
<tbody>
    <tr><th scope=row>1/02/2015</th><td>1</td><td>3</td></tr>
    <tr><th scope=row>2/03/2015</th><td>2</td><td>4</td></tr>
</tbody>
</table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Convert dat into xts</span>
xts<span class="p">(</span>dat<span class="p">,</span> order.by <span class="o">=</span> <span class="kp">as.Date</span><span class="p">(</span><span class="kp">rownames</span><span class="p">(</span>dat<span class="p">),</span> <span class="s">&quot;%m%d%Y&quot;</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>     a b
&amp;lt;NA&amp;gt; 1 3
&amp;lt;NA&amp;gt; 2 4
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Read tmp_file using read.zoo and as.xts</span>
dat_xts <span class="o">&lt;-</span> as.xts<span class="p">(</span>read.zoo<span class="p">(</span><span class="s">&#39;tmp_file.csv&#39;</span><span class="p">,</span> index.column <span class="o">=</span> <span class="m">0</span><span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="p">,</span> format <span class="o">=</span> <span class="s">&quot;%m/%d/%Y&quot;</span><span class="p">))</span>
dat_xts
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>           a b
2015-01-02 1 3
2015-02-03 2 4
</pre></div>
</td></tr></table>

<p><strong>Exporting xts objects</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kp">head</span><span class="p">(</span>sunspots<span class="p">,</span> <span class="m">5</span><span class="p">)</span>

<span class="c1"># Convert sunspots to xts</span>
sunspots_xts <span class="o">&lt;-</span> as.xts<span class="p">(</span>sunspots<span class="p">)</span>
</pre></div>
</td></tr></table>

<ol>
    <li>58</li>
    <li>62.6</li>
    <li>70</li>
    <li>55.7</li>
    <li>85</li>
</ol>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Get the temporary file name</span>
tmp <span class="o">&lt;-</span> <span class="kp">tempfile</span><span class="p">()</span>

<span class="c1"># Write the xts object using zoo to tmp </span>
write.zoo<span class="p">(</span>sunspots<span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="p">,</span> file <span class="o">=</span> tmp<span class="p">)</span>

tmp
</pre></div>
</td></tr></table>

<p>&lsquo;/tmp/RtmptS40lc/file18ce2b6bba8&rsquo;</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Read the tmp file</span>
<span class="c1"># FUN=as.yearmon will convert strings such as Jan 1749 into a proper time class</span>
sun <span class="o">&lt;-</span> read.zoo<span class="p">(</span>tmp<span class="p">,</span> sep <span class="o">=</span> <span class="s">&quot;,&quot;</span><span class="p">,</span> FUN <span class="o">=</span> as.yearmon<span class="p">)</span>

<span class="c1"># Convert sun into xts</span>
sun_xts <span class="o">&lt;-</span> as.xts<span class="p">(</span>sun<span class="p">)</span>
<span class="kp">head</span><span class="p">(</span>sun_xts<span class="p">,</span> <span class="m">5</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>         [,1]
jan 1749 58.0
fév 1749 62.6
mar 1749 70.0
avr 1749 55.7
mai 1749 85.0
</pre></div>
</td></tr></table>

<p><strong>The ISO8601 Standard</strong></p>
<p>The ISO8601 standard is the internationally recognized and accepted way to represent dates and times. From the biggest to the smallest, left to right, YYYY-MM-DDTHH:MM:SS.</p>
<p>The standard allows for a common format to not only describe dates, but also a way to represent ranges and repeating intervals:</p>
<ol>
<li>2004 or 2001/2015</li>
<li>201402/03</li>
<li>2014-02-22 08:30:00</li>
<li>T08:00/T09:00</li>
</ol>
<p><strong>Querying for dates</strong></p>
<p>Date ranges can be extracted from xts objects by simply specifying the period(s) you want using special character strings in your subset.</p>
<p>Code:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>A<span class="p">[</span><span class="s">&quot;201601&quot;</span><span class="p">]</span>         <span class="c1">## Jan 2016</span>
A<span class="p">[</span><span class="s">&quot;20160125&quot;</span><span class="p">]</span>       <span class="c1">## Jan 25, 2016</span>
A<span class="p">[</span><span class="s">&quot;201203/201212&quot;</span><span class="p">]</span>  <span class="c1">## Feb to Dec 2012</span>

<span class="c1"># Select all of 2016 from x</span>
x_2016 <span class="o">&lt;-</span> x<span class="p">[</span><span class="s">&quot;2016&quot;</span><span class="p">]</span>

<span class="c1"># Select January 2016 to March 22</span>
jan_march <span class="o">&lt;-</span> x<span class="p">[</span><span class="s">&quot;201601/20160322&quot;</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p><strong>Extracting recurring intraday intervals</strong></p>
<p>Most common data &ldquo;in the wild&rdquo; is daily. On ocassion you may find yourself working with intraday data, that is date plus times.</p>
<p>You can slice days easily by using special notation in the <code class="codehilite">i =</code> argument to the single bracket extraction (i.e. <code class="codehilite">[i,j]</code>).</p>
<p>Code:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Intraday times for all days</span>
NYSE<span class="p">[</span><span class="s">&quot;T09:30/T16:00&quot;</span><span class="p">]</span>

<span class="c1"># Extract all data between 8AM and 10AM</span>
morn_2010 <span class="o">&lt;-</span> irreg<span class="p">[</span><span class="s">&quot;T8:00/T10:00&quot;</span><span class="p">]</span>

<span class="c1"># Extract the observations for January 13th</span>
morn_2010<span class="p">[</span><span class="s">&quot;2010-01-13&quot;</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p><strong>Alternating extraction techniques</strong></p>
<p>Often times you may need to subset an existing time series with a set of Dates, or time-based objects. These might be from <code class="codehilite">as.Date()</code>, or <code class="codehilite">as.POSIXct()</code>, or a variety of other classes.</p>
<p>Code:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Subset x using the vector dates</span>
x<span class="p">[</span>dates<span class="p">]</span>

<span class="c1"># Subset x using dates as POSIXct</span>
x<span class="p">[</span><span class="kp">as.POSIXct</span><span class="p">(</span>dates<span class="p">)]</span>
</pre></div>
</td></tr></table>

<p><strong>Extracting recurring intraday intervals</strong></p>
<p>The most common time series data is daily, intraday data, which contains both dates and times. </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Extract all data between 8AM and 10AM</span>
morn_2010 <span class="o">&lt;-</span> irreg<span class="p">[</span><span class="s">&quot;T8:00/T10:00&quot;</span><span class="p">]</span>

<span class="c1"># Extract the observations for January 13th</span>
morn_2010<span class="p">[</span><span class="s">&quot;2010-01-13&quot;</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p><strong>Row selection with time objects</strong></p>
<p>Subset an existing time series with a set of Dates, or time-based objects.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Subset x using the vector dates</span>
x<span class="p">[</span>dates<span class="p">]</span>

<span class="c1"># Subset x using dates as POSIXct</span>
x<span class="p">[</span><span class="kp">as.POSIXct</span><span class="p">(</span>dates<span class="p">)]</span>
</pre></div>
</td></tr></table>

<p><strong>Update and replace elements</strong></p>
<p>Replace known intervals or observations with an NA, say due to a malfunctioning sensor on a particular day or a set of outliers given a holiday.</p>
<p>Code:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Replace all values in x on dates with NA</span>
x<span class="p">[</span>dates<span class="p">]</span> <span class="o">&lt;-</span> <span class="kc">NA</span>

<span class="c1"># Replace dates from 2016-06-09 and on with 0</span>
x<span class="p">[</span><span class="s">&quot;20160609/&quot;</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">0</span>
</pre></div>
</td></tr></table>

<p><strong>Find the <code class="codehilite">first</code> or <code class="codehilite">last</code> period of time</strong></p>
<p>Sometimes you need to locate data by relative time. Instead of using an absolute offset, you describe a position relative in time. A simple example would be something like the <em>last 3 weeks</em> of a series, or the <em>first day of current month</em>.</p>
<p>Code:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Create lastweek with using the last 1 week of temps</span>
lastweek <span class="o">&lt;-</span> last<span class="p">(</span>temps<span class="p">,</span> <span class="s">&quot;1 week&quot;</span><span class="p">)</span>

<span class="c1"># Print the last 2 observations in lastweek</span>
last<span class="p">(</span>lastweek<span class="p">,</span> <span class="m">2</span><span class="p">)</span>

<span class="c1"># Extract all but the last two days of lastweek</span>
last<span class="p">(</span>lastweek<span class="p">,</span> <span class="s">&quot;-2 day&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Combining <code class="codehilite">first</code> and <code class="codehilite">last</code></strong></p>
<p>Code:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Last 3 days of first week</span>
last<span class="p">(</span>first<span class="p">(</span>Temps<span class="p">,</span> <span class="s">&#39;1 week&#39;</span><span class="p">),</span><span class="s">&#39;3 days&#39;</span><span class="p">)</span> 

<span class="c1"># Extract the first three days of the second week of temps</span>
first<span class="p">(</span>last<span class="p">(</span>first<span class="p">(</span>temps<span class="p">,</span> <span class="s">&quot;2 week&quot;</span><span class="p">),</span> <span class="s">&quot;1 week&quot;</span><span class="p">),</span> <span class="s">&quot;3 day&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Matrix arithmetic - add, subtract, multiply and divide in time!</strong></p>
<p>When you perform any binary operation using two xts objects, these objects are first aligned using the intersection of the indexes to preserve the point-in-time aspect of your data, assuring that you don&rsquo;t introduce accidental look ahead (or look behind!) bias into your calculations.</p>
<p>Your options include:</p>
<ol>
<li>coredata() or as.numeric() (drop one to a matrix or vector).</li>
<li>Manually shift index values - i.e. use lag().</li>
<li>Reindex your data (before or after the calculation).</li>
</ol>
<p><code class="codehilite">xts</code> respects time and will only return the intersection of times when doing various mathematical operations. First option:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Add a and b</span>
a <span class="o">+</span> b

<span class="c1"># Add a with the numeric value of b</span>
a <span class="o">+</span> <span class="kp">as.numeric</span><span class="p">(</span>b<span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Math with non-overlapping indexes</strong></p>
<p>This third way involves modifying the two series you want by aligning assuring you have some union of dates - the dates you require in your final output. This makes it possibly to preserve dimensionality of the data:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kp">merge</span><span class="p">(</span>b<span class="p">,</span> index<span class="p">(</span>a<span class="p">))</span>

<span class="c1"># Add a to b, and fill all missing rows of b with 0</span>
a <span class="o">+</span> <span class="kp">merge</span><span class="p">(</span>b<span class="p">,</span> index<span class="p">(</span>a<span class="p">),</span> fill <span class="o">=</span> <span class="m">0</span><span class="p">)</span>

<span class="c1"># Add a to b and fill NAs with the last observation</span>
a <span class="o">+</span> <span class="kp">merge</span><span class="p">(</span>b<span class="p">,</span> index<span class="p">(</span>a<span class="p">),</span> fill <span class="o">=</span> na.locf<span class="p">)</span>
</pre></div>
</td></tr></table>

<h3 id="merging-and-modifying-time-series">Merging and modifying time series<a class="headerlink" href="#merging-and-modifying-time-series" title="Permanent link">&para;</a></h3>
<p><strong>Combining <code class="codehilite">xts</code> by column with <code class="codehilite">merge</code></strong></p>
<p><code class="codehilite">xts</code> makes it easy to join data by column and row using a few different functions.  </p>
<p><code class="codehilite">xts</code> objects must be of identical type (e.g. integer + integer), or be POSIXct dates vector, or be atomic vectors of the same type (e.g. numeric), or be a single NA. It does not work on data.frames with various column types.</p>
<p>One of the most important functions to accomplish this is <code class="codehilite">merge</code>. It works like a <code class="codehilite">cbind</code> or and SQL <code class="codehilite">join</code>:</p>
<ol>
<li>inner join (and)</li>
<li>outer join (or)</li>
<li>left join</li>
<li>right join</li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Basic argument use</span>
<span class="kp">merge</span><span class="p">(</span>a<span class="p">,</span> b<span class="p">,</span> join <span class="o">=</span> <span class="s">&quot;right&quot;</span><span class="p">,</span> fill <span class="o">=</span> <span class="m">9999</span><span class="p">)</span>

<span class="c1"># Perform an inner join of a and b</span>
<span class="kp">merge</span><span class="p">(</span>a<span class="p">,</span> b<span class="p">,</span> join <span class="o">=</span> <span class="s">&quot;inner&quot;</span><span class="p">)</span>

<span class="c1"># Perform of a left-join of a and b, fill mising values with 0</span>
<span class="kp">merge</span><span class="p">(</span>a<span class="p">,</span> b<span class="p">,</span> join <span class="o">=</span> <span class="s">&quot;left&quot;</span><span class="p">,</span> fill <span class="o">=</span> <span class="m">0</span><span class="p">)</span>

<span class="c1"># fill = na.locf, fill = NA</span>
</pre></div>
</td></tr></table>

<p><strong>Combining <code class="codehilite">xts</code> by row with <code class="codehilite">rbind</code></strong></p>
<p>Easy to add new rows to your data.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Row bind temps_june30 to temps, assign this to temps2</span>
temps2 <span class="o">&lt;-</span> <span class="kp">rbind</span><span class="p">(</span>temps<span class="p">,</span> temps_june30<span class="p">)</span>

<span class="c1"># Row bind temps_july17 and temps_july18 to temps2, call this temps3</span>
temps3 <span class="o">&lt;-</span> <span class="kp">rbind</span><span class="p">(</span>temps2<span class="p">,</span> temps_july17<span class="p">,</span> temps_july18<span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Fill missing values using last or previous observation</strong></p>
<p>The <code class="codehilite">na.locf</code> function takes the last-observation-carried-forward approach.</p>
<p>The <code class="codehilite">xts</code> package leverages the power of <code class="codehilite">zoo</code> for help with this. <code class="codehilite">zoo</code> provides a variety of missing data handling functions which are usable by <code class="codehilite">xts</code>, and very handy.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Last obs. carried forward</span>
na.locf<span class="p">(</span>x<span class="p">)</span>                

<span class="c1"># Next obs. carried backward</span>
na.locf<span class="p">(</span>x<span class="p">,</span> fromLast <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="c1"># Fill missing values using the last observation</span>
na.locf<span class="p">(</span>temps<span class="p">,</span> na.rm <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
                fromLast <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="c1"># Fill missing values using the next observation</span>
na.locf<span class="p">(</span>temps<span class="p">,</span> na.rm <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="c1"># maxgap = Inf</span>
<span class="c1"># rule = 2,</span>
</pre></div>
</td></tr></table>

<p><strong>NA interpolation</strong></p>
<p>From <code class="codehilite">zoo</code>.</p>
<p>On occassion, a simple carry forward approach to missingness isn&rsquo;t appropriate. It may be that a series is missing an observation due to a higher frequency sampling than the generating process. You might also encounter an observation that is in error, yet expected to be somewhere between the values of its neighboring observations.</p>
<p>Both of these cases are examples of where interpolation is useful.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Interpolate NAs using linear approximation</span>
na.approx<span class="p">(</span>AirPass<span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Combine a leading and lagging time series</strong></p>
<p>Another common modification for time series is the ability to lag a series.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Your final object</span>
lag<span class="p">(</span>x<span class="p">,</span> k <span class="o">=</span> <span class="m">1</span><span class="p">,</span> na.pad <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="c1"># k = -1  leading</span>
<span class="c1"># k = 1   lagging</span>
<span class="c1"># zoo uses the other way around</span>

<span class="c1"># k = c(0, 1, 5)  multiple leads or lags</span>

<span class="c1"># Create a leading object called lead_x</span>
lead_x <span class="o">&lt;-</span> lag<span class="p">(</span>x<span class="p">,</span> k <span class="o">=</span> <span class="m">-1</span><span class="p">)</span>

<span class="c1"># Create a lagging object called lag_x</span>
lag_x <span class="o">&lt;-</span> lag<span class="p">(</span>x<span class="p">,</span> k <span class="o">=</span> <span class="m">1</span><span class="p">)</span>

<span class="c1"># Merge your three series together and assign to z</span>
z <span class="o">&lt;-</span> <span class="kp">merge</span><span class="p">(</span>lead_x<span class="p">,</span> x<span class="p">,</span> lag_x<span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Calculate a difference of a series with <code class="codehilite">diff</code></strong></p>
<p>Another common operation on time series, typically on those that are non-stationary, is to take a difference of the series.</p>
<p><code class="codehilite">differences</code> is the order of the difference (how many times <code class="codehilite">diff</code> is called). A simple way to view a single (or <em>first order</em>) difference is to see it as <code class="codehilite">x(t) - x(t-k)</code> where <code class="codehilite">k</code> is the number of lags to go back. Higher order differences are simply the reapplication of a difference to each prior result (like a second derivative or a difference of the difference).</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kp">diff</span><span class="p">(</span>x<span class="p">,</span> lag <span class="o">=</span> <span class="m">1</span><span class="p">,</span> difference <span class="o">=</span> <span class="m">1</span><span class="p">,</span> log <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> na.pad <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="c1"># calculate the first difference of AirPass using lag and subtraction</span>
AirPass <span class="o">-</span> lag<span class="p">(</span>AirPass<span class="p">,</span> k <span class="o">=</span> <span class="m">1</span><span class="p">)</span>

<span class="c1"># calculate the first order 12-month difference if AirPass</span>
<span class="kp">diff</span><span class="p">(</span>AirPass<span class="p">,</span> lag <span class="o">=</span> <span class="m">12</span><span class="p">,</span> differences <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>What is the key difference in lag between xts and zoo? The <code class="codehilite">k</code> argument in <code class="codehilite">zoo</code> uses positive values for shifting past observations forward.</p>
<h3 id="apply-and-aggregate-by-time">Apply and aggregate by time<a class="headerlink" href="#apply-and-aggregate-by-time" title="Permanent link">&para;</a></h3>
<p><strong>Find intervals by time in <code class="codehilite">xts</code></strong></p>
<p>The main function in xts to facilitate this is endpoints. It takes a time series (or a vector of times) and returns the locations of the last observations in each interval.</p>
<p>For example, the code below locates the last observation of each year for the <code class="codehilite">AirPass</code> dataset:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>endpoints<span class="p">(</span>AirPass<span class="p">,</span> on <span class="o">=</span> <span class="s">&quot;years&quot;</span><span class="p">)</span>

<span class="c1"># The argument on supports a variety of periods, including &quot;years&quot;, &quot;quarters&quot;, &quot;months&quot;, as well as intraday intervals such as &quot;hours&quot;, and &quot;minutes&quot;</span>

<span class="c1"># on = &quot;weeks&quot;, k = 2, the result would be the final day of every other week in your data</span>

<span class="c1"># Locate the final day of every week</span>
endpoints<span class="p">(</span>temps<span class="p">,</span> on <span class="o">=</span> <span class="s">&quot;weeks&quot;</span><span class="p">)</span>

<span class="c1"># Locate the final day of every two weeks</span>
endpoints<span class="p">(</span>temps<span class="p">,</span> on <span class="o">=</span> <span class="s">&quot;weeks&quot;</span><span class="p">,</span> k <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Apply a function by time period(s)</strong></p>
<p><code class="codehilite">xts</code> provides <code class="codehilite">period.apply</code>, which takes a time series, an <code class="codehilite">INDEX</code> of endpoints, and a function to <code class="codehilite">apply</code>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>period.apply<span class="p">(</span>x<span class="p">,</span> INDEX<span class="p">,</span> FUN<span class="p">,</span> <span class="kc">...</span><span class="p">)</span>

<span class="c1"># Calculate the weekly endpoints</span>
ep <span class="o">&lt;-</span> endpoints<span class="p">(</span>temps<span class="p">,</span> on <span class="o">=</span> <span class="s">&quot;weeks&quot;</span><span class="p">)</span>

<span class="c1"># Now calculate the weekly mean and display the results</span>
period.apply<span class="p">(</span>temps<span class="p">[,</span> <span class="s">&quot;Temp.Mean&quot;</span><span class="p">],</span> INDEX <span class="o">=</span> ep<span class="p">,</span> FUN <span class="o">=</span> <span class="kp">mean</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Using <code class="codehilite">lapply</code> and <code class="codehilite">split</code> to apply functions on intervals</strong></p>
<p>Often it is useful to physically split your data into disjoint chunks by time and perform some calculation on these periods.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Split temps by week</span>
temps_weekly <span class="o">&lt;-</span> <span class="kp">split</span><span class="p">(</span>temps<span class="p">,</span> f <span class="o">=</span> <span class="s">&quot;weeks&quot;</span><span class="p">)</span>

<span class="c1"># Create a list of weekly means</span>
<span class="kp">lapply</span><span class="p">(</span>X <span class="o">=</span> temps_weekly<span class="p">,</span> FUN <span class="o">=</span> <span class="kp">mean</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Selection by <code class="codehilite">endpoints</code> vs. <code class="codehilite">split-lapply-rbind</code></strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># use the proper combination of split, lapply and rbind.</span>
<span class="c1">#T1 &lt;- do.call(rbind, ___(___(Temps, &quot;weeks&quot;), function(w) last(w, n=&quot;___&quot;)))</span>
T1 <span class="o">&lt;-</span> <span class="kp">do.call</span><span class="p">(</span><span class="kp">rbind</span><span class="p">,</span> <span class="kp">lapply</span><span class="p">(</span><span class="kp">split</span><span class="p">(</span>Temps<span class="p">,</span> <span class="s">&quot;weeks&quot;</span><span class="p">),</span> <span class="kr">function</span><span class="p">(</span>w<span class="p">)</span> last<span class="p">(</span>w<span class="p">,</span> n<span class="o">=</span> <span class="s">&quot;1 day&quot;</span><span class="p">)))</span>

<span class="c1"># now subset Temps using the results of &#39;endpoints&#39;</span>
last_day_of_weeks <span class="o">&lt;-</span> endpoints<span class="p">(</span>Temps<span class="p">,</span> on <span class="o">=</span> <span class="s">&quot;weeks&quot;</span><span class="p">)</span>
T2 <span class="o">&lt;-</span> Temps<span class="p">[</span>last_day_of_weeks<span class="p">]</span>
</pre></div>
</td></tr></table>

<p><strong>Convert univariate series to OHLC data</strong></p>
<p>In financial series it is common to find Open-High-Low-Close data calculated over some repeating and regular interval.</p>
<p>Also known as range bars, aggregating a series based on some regular window can make analysis easier amongst series that have varying frequencies. For example, a weekly economic series and a daily stock series can be compared more easily if the daily is converted to weekly.</p>
<p>OHLC means Opening, High, Low, Closing values.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>to.period<span class="p">(</span>x<span class="p">,</span>
          period <span class="o">=</span> <span class="s">&quot;months&quot;</span><span class="p">,</span> 
          k <span class="o">=</span> <span class="m">1</span><span class="p">,</span> 
          indexAt<span class="p">,</span> 
          name<span class="o">=</span><span class="kc">NULL</span><span class="p">,</span>
          OHLC <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
          <span class="kc">...</span><span class="p">)</span>

<span class="c1"># Convert USDEUR to weekly</span>
<span class="c1"># OHLC = FALSE by default</span>
USDEUR_weekly <span class="o">&lt;-</span> to.period<span class="p">(</span>USDEUR<span class="p">,</span> period <span class="o">=</span> <span class="s">&quot;weeks&quot;</span><span class="p">)</span>
<span class="kp">head</span><span class="p">(</span>USDEUR<span class="p">)</span>
<span class="kp">head</span><span class="p">(</span>USDEUR_weekly<span class="p">)</span>

<span class="c1"># Convert USDEUR_weekly to monthly</span>
USDEUR_monthly <span class="o">&lt;-</span> to.period<span class="p">(</span>USDEUR_weekly<span class="p">,</span> period <span class="o">=</span> <span class="s">&quot;months&quot;</span><span class="p">)</span>

<span class="c1"># Convert USDEUR_monthly to yearly univariate</span>
USDEUR_yearly <span class="o">&lt;-</span> to.period<span class="p">(</span>USDEUR_monthly<span class="p">,</span> period <span class="o">=</span> <span class="s">&quot;years&quot;</span><span class="p">,</span> OHLC <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Convert a series to a lower frequency</strong></p>
<p>Besides converting univariate time series to OHLC series, to.period() also lets you convert OHLC to lower regularized frequency - something like subsampling your data.</p>
<p>For example, when using the shortcut function <code class="codehilite">to.quarterly()</code> xts will convert your index to the <code class="codehilite">yearqtr</code> class to make periods more obvious.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Convert EqMktNeutral to quarterly OHLC</span>
mkt_quarterly <span class="o">&lt;-</span> to.period<span class="p">(</span>EqMktNeutral<span class="p">,</span> period <span class="o">=</span> <span class="s">&quot;quarters&quot;</span><span class="p">)</span>

<span class="c1"># Convert EqMktNeutral to quarterly using shortcut function</span>
<span class="c1"># Change the base name of each OHLC column to EDHEC.Equity and change the index to &quot;firstof&quot;</span>
mkt_quarterly2 <span class="o">&lt;-</span> to.quarterly<span class="p">(</span>EqMktNeutral<span class="p">,</span> name <span class="o">=</span> <span class="s">&quot;EDHEC.Equity&quot;</span><span class="p">,</span> indexAt <span class="o">=</span> <span class="s">&quot;first&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Calculate basic rolling value of series by month</strong></p>
<p>Rolling windows can be discrete: use <code class="codehilite">lapply</code> with (<code class="codehilite">cumsum, cumprod, cummax, cummin</code>) and <code class="codehilite">split</code>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># split-lapply-rbind pattern</span>

x_split <span class="o">&lt;-</span> <span class="kp">split</span><span class="p">(</span>x<span class="p">,</span> f <span class="o">=</span> <span class="s">&quot;months&quot;</span><span class="p">)</span>
x_list <span class="o">&lt;-</span> <span class="kp">lapply</span><span class="p">(</span>x_split<span class="p">,</span> <span class="kp">cummax</span><span class="p">)</span>
x_list_rbind <span class="o">&lt;-</span> <span class="kp">do.call</span><span class="p">(</span><span class="kp">rbind</span><span class="p">,</span> x_list<span class="p">)</span>

<span class="c1"># Split edhec into years</span>
edhec_years <span class="o">&lt;-</span> <span class="kp">split</span><span class="p">(</span>edhec <span class="p">,</span> f <span class="o">=</span> <span class="s">&quot;years&quot;</span><span class="p">)</span>

<span class="c1"># Use lapply to calculate the cumsum for each year</span>
edhec_ytd <span class="o">&lt;-</span> <span class="kp">lapply</span><span class="p">(</span>edhec_years<span class="p">,</span> FUN <span class="o">=</span> <span class="kp">cumsum</span><span class="p">)</span>

<span class="c1"># Use do.call to rbind the results</span>
edhec_xts <span class="o">&lt;-</span> <span class="kp">do.call</span><span class="p">(</span><span class="kp">rbind</span><span class="p">,</span> edhec_ytd<span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Calculate the rolling standard deviation of a time series</strong></p>
<p>Rolling windows can be continuous: use <code class="codehilite">rollapply</code>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>rollapply<span class="p">(</span>x<span class="p">,</span> <span class="m">10</span><span class="p">,</span> FUN <span class="o">=</span> <span class="kp">max</span><span class="p">,</span> na.rm <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="c1"># Use rollapply to calculate the rolling 3 period sd of EqMktNeutral</span>
eq_monthly <span class="o">&lt;-</span> rollapply<span class="p">(</span>EqMktNeutral<span class="p">,</span> <span class="m">3</span><span class="p">,</span> FUN <span class="o">=</span> sd<span class="p">)</span>
</pre></div>
</td></tr></table>

<h3 id="extra-features-of-xts">Extra features of xts<a class="headerlink" href="#extra-features-of-xts" title="Permanent link">&para;</a></h3>
<p><strong>Index, attributes, and time zones</strong></p>
<p>All time is stored in seconds since 1970-01-01. Time via <code class="codehilite"><span class="na">.index</span><span class="p">()</span></code> () and <code class="codehilite">index()</code> (raw seconds since 1970-01-01).</p>
<p><code class="codehilite">index()</code> returns the time of an <code class="codehilite">xts</code> object, as a vector of class <code class="codehilite">indexClass</code>.</p>
<p><code class="codehilite">Sys.setenv()</code>.</p>
<p><strong>Class attributes - <code class="codehilite">tclass</code>, <code class="codehilite">tzone</code> and <code class="codehilite">tformat</code></strong></p>
<p><code class="codehilite">xts</code> objects are somewhat tricky when it comes to times. Internally, we have now seen that the index attribute is really a vector of numeric values corresponding to the seconds since the UNIX epoch (1970-01-01).</p>
<p>How these values are displayed on printing and how they are returned to the user when using the <code class="codehilite">index()</code> function is dependent on a few key internal attributes.</p>
<p>The information that controls this behavior can be viewed and even changed through a set of accessor functions detailed below:</p>
<ul>
<li>The index class using indexClass (e.g. from Date to chron)</li>
<li>The time zone using indexTZ (e.g. from America/Chicago to Europe/London)</li>
<li>The time format to be displayed via indexFormat (e.g. YYYY/MM/DD)</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Get the index class of temps</span>
indexClass<span class="p">(</span>temps<span class="p">)</span>

<span class="c1"># Get the timezone of temps</span>
indexTZ<span class="p">(</span>temps<span class="p">)</span>

<span class="c1"># Change the format of the time display</span>
indexFormat<span class="p">(</span>temps<span class="p">)</span> <span class="o">&lt;-</span> <span class="s">&quot;M/DD/YYYY&quot;</span>

<span class="c1"># Extract the new index</span>
time<span class="p">(</span>temps<span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Time zones - (and why you should care!)</strong></p>
<p>R provides time zone support in native classes <code class="codehilite">POSIXct</code> and <code class="codehilite">POSIXlt</code>. xts extends this power to the entire object, allowing you to have multiple timezones across various objects. One very important thing to remember is that some internal operation system functions require a timezone to do date math, and if not set one is chosen for you! Be careful to always set a timezone in your environment to prevent very hard to debug errors when working with dates and times. </p>
<p><code class="codehilite">xts</code> provides the function <code class="codehilite">tzone</code>. This function allows to you to extract, or set timezones. <code class="codehilite">tzone<span class="p">(</span>x<span class="p">)</span> <span class="o">&lt;-</span> <span class="s">&quot;Time_Zone&quot;</span></code> In this exercise you will work with an object called times to practice constructing your own xts objects with custom time zones.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Construct times_xts with TZ set to America/Chicago</span>
times_xts <span class="o">&lt;-</span> xts<span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span> order.by <span class="o">=</span> times<span class="p">,</span> tzone <span class="o">=</span> <span class="s">&quot;America/Chicago&quot;</span><span class="p">)</span>

<span class="c1"># Change the time zone to Asia/Hong_Kong</span>
tzone<span class="p">(</span>times_xts<span class="p">)</span> <span class="o">&lt;-</span> <span class="s">&quot;Asia/Hong_Kong&quot;</span>

<span class="c1"># Extract the current timezone </span>
indexTZ<span class="p">(</span>times_xts<span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Periods, periodicity, and timestamps</strong></p>
<p>Periods (yearly or intradays time index?): <code class="codehilite">periodicity()</code></p>
<p>Broken downtime with <code class="codehilite"><span class="na">.index</span><span class="p">*</span></code>, <code class="codehilite"><span class="na">.index</span><span class="p">()</span></code>, <code class="codehilite"><span class="na">.indexmday</span><span class="p">()</span></code>, <code class="codehilite">indexyday()</code>, <code class="codehilite">indexyear()</code>.</p>
<p>Timestamps.</p>
<p><code class="codehilite">align.time()</code> round time stamps to another period.</p>
<p><code class="codehilite">make.index.unique()</code> removes observations from duplicate time stamps.</p>
<p><strong>Determining periodicity</strong></p>
<p>The idea of periodicity is pretty simple; with what regularity does your data repeat? For stock market data, you might have hourly prices or maybe daily open-high-low-close bars. For macro economic series, it might be monthly or weekly survey numbers.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Calculate the periodicity of temps</span>
periodicity<span class="p">(</span>temps<span class="p">)</span>

<span class="c1"># Calculate the periodicity of edhec</span>
periodicity<span class="p">(</span>edhec<span class="p">)</span>

<span class="c1"># Convert edhec to yearly</span>
edhec_yearly <span class="o">&lt;-</span> to.yearly<span class="p">(</span>edhec<span class="p">,</span> <span class="m">12</span><span class="p">)</span>

<span class="c1"># Calculate the periodicity of edhec_yearly</span>
periodicity<span class="p">(</span>edhec_yearly<span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Find the number of periods in your data</strong></p>
<p>Often times it is handy to know not just the range of your time series index, but also have an idea of how many discrete irregular periods this covers. xts provides a set of functions to do just that. If you have a time series, it is now easy to see how many days, weeks or years your data contains.</p>
<p>Count: <code class="codehilite">nseconds()</code>, <code class="codehilite">nminutes()</code>, <code class="codehilite">nhours()</code>, etc.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>`<span class="c1"># Count the months</span>
nmonths<span class="p">(</span>edhec<span class="p">)</span>

<span class="c1"># Count the quarters</span>
nquarters<span class="p">(</span>edhec<span class="p">)</span>

<span class="c1"># Count the years</span>
nyears<span class="p">(</span>edhec<span class="p">)</span>  
</pre></div>
</td></tr></table>

<p><strong>Secret index tools</strong></p>
<p>Normally you want to access the times you stored. <code class="codehilite">index()</code> does this magically for you by using your <code class="codehilite">indexClass</code>. To get to the raw vector another function is provided, <code class="codehilite"><span class="na">.index</span><span class="p">()</span></code>. Note the critical dot before the function name.</p>
<p>More useful than extracting raw seconds is the ability to extract time components similar to the <code class="codehilite">POSIXlt</code> class, which mirrors closely the underlying POSIX internal compiled structure <code class="codehilite">tm</code>. This is provided by a handful of functions such as <code class="codehilite"><span class="na">.indexday</span><span class="p">()</span></code>, <code class="codehilite"><span class="na">.indexmon</span><span class="p">()</span></code>, <code class="codehilite"><span class="na">.indexyear</span><span class="p">()</span></code> and more.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Explore underlying units of temps</span>
<span class="m">.i</span>ndex<span class="p">(</span>temps<span class="p">)</span> <span class="c1"># in seconds</span>
<span class="m">.i</span>ndexwday<span class="p">(</span>temps<span class="p">)</span> <span class="c1"># (0 for Sun, 1, 2,..., 6 for Sat) day of the week</span>

<span class="c1"># Create an index using which (Sunday has a value of 0, and Saturday has a value of 6)</span>
index <span class="o">&lt;-</span> <span class="kp">which</span><span class="p">(</span><span class="m">.i</span>ndexwday<span class="p">(</span>temps<span class="p">)</span> <span class="o">==</span> <span class="m">0</span> <span class="o">|</span> <span class="m">.i</span>ndexwday<span class="p">(</span>temps<span class="p">)</span> <span class="o">==</span> <span class="m">6</span><span class="p">)</span>

<span class="c1"># Select the index</span>
temps<span class="p">[</span>index<span class="p">]</span>
</pre></div>
</td></tr></table>

<p><strong>Modifying timestamps</strong></p>
<p>Depending on your field you might encounter higher frequency data - think intraday trading intervals, or sensor data from medical equipment.</p>
<p>If you find that you have observations with identical timestamps, it might be useful to perturb or remove these times to allow for uniqueness.</p>
<p>On other ocassions you might find your timestamps a bit too precise. In these instances it might be better to round up to some fixed interval, for example an observation may occur at any point in an hour, but you want to record the latest as of beginning of the next hour.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>make.index.unique<span class="p">(</span>x<span class="p">,</span> eps <span class="o">=</span> <span class="m">1e-4</span><span class="p">)</span>  <span class="c1"># Perturb</span>
make.index.unique<span class="p">(</span>x<span class="p">,</span> drop <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># Drop duplicates</span>
align.time<span class="p">(</span>x<span class="p">,</span> n <span class="o">=</span> <span class="m">60</span><span class="p">)</span> <span class="c1"># Round to the minute</span>

<span class="c1"># Make z have unique timestamps</span>
make.index.unique<span class="p">(</span>z<span class="p">,</span> eps <span class="o">=</span> <span class="m">1e-4</span><span class="p">)</span>

<span class="c1"># Remove duplicate times in z</span>
make.index.unique<span class="p">(</span>z<span class="p">,</span> drop <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="c1"># Round observations to the next time</span>
align.time<span class="p">(</span>z<span class="p">,</span> n <span class="o">=</span> <span class="m">3600</span><span class="p">)</span> <span class="c1"># next hour</span>
</pre></div>
</td></tr></table>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Big_Data_Analysis_with_Revolution_R_Enterprise/" title="Big Data Analysis with Revolution R Enterprise" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Big Data Analysis with Revolution R Enterprise
              </span>
            </div>
          </a>
        
        
          <a href="../Parallel computing in R/" title="Parallel computing in R" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Parallel computing in R
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            © Ugo Sparks
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.b41f3d20.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
        <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-93008985-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(a){a.host!=document.location.host&&a.addEventListener("click",function(){var e=a.getAttribute("data-md-action")||"follow";ga("send","event","outbound",e,a.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
  </body>
</html>